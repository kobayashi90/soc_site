(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{2252:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/search",function(){return c(1025)}])},1025:function(g,b,a){"use strict";a.r(b),a.d(b,{"__N_SSP":function(){return G},default:function(){return H}});var h=a(4924),i=a(6042),j=a(9396),k=a(828),l=a(7297),m=a(5893),n=a(1163),o=a(7283),p=a(3359),q=a(1608),r=a(1555),s=a(682),t=a(9368),c=a(4184),u=a.n(c),d=a(5675),v=a.n(d),e=a(1664),w=a.n(e),x=a(782),f=a(6666),y=a.n(f),z=a(1331),A=a(5043),B=a(7294),C=a(2729);function D(){var a=(0,l.Z)(["\n  ","{\n    byTitle: ","\n    byArtist: ","\n    games: ","\n    studios: ","\n    anims: ","\n    series: ","\n  }\n  "]);return D=function(){return a},a}function E(){var a=(0,l.Z)(["\n      ","{\n        result: ","\n      }\n    "]);return E=function(){return a},a}var F="query Search($title: String!, $limit: Int!, $page: Int!)",G=!0;function H(){var b=(0,C.Z)(),d=(0,n.useRouter)(),c=d.query.q,a={byTitle:{query:"searchAlbum(title: $title, limit: $limit, page: $page){ count, items: rows { id, title, categories { name }, releaseDate, placeholder } }",title:b("Albums"),type:"album"},byArtist:{query:"searchAlbumByArtist(name: $title, limit: $limit, page: $page){ count, items: rows { id, title, categories { name }, releaseDate, placeholder } }",title:"".concat(b("Albums")," (","by artists",")"),type:"album"},games:{query:"searchGame(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name, releaseDate, placeholder } }",title:b("Games"),type:"game"},studios:{query:"searchStudio(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name } }",title:b("Studios")},anims:{query:"searchAnimation(title: $title, limit: $limit, page: $page){ count, items: rows { id, title, releaseDate, placeholder } }",title:b("Animations"),type:"anim"},series:{query:"searchSeries(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name, placeholder } }",title:b("Series"),type:"series"}},l={};Object.keys(a).forEach(function(a){l[a]=!1});var t=(0,o.Ps)(D(),F,a.byTitle.query,a.byArtist.query,a.games.query,a.studios.query,a.anims.query,a.series.query),e=(0,k.Z)((0,p.t)(t,{variables:{title:c,limit:30,page:0}}),2),u=e[0],f=e[1],v=f.data,w=f.loading,g=(0,B.useState)(l),x=g[0],z=g[1],y=w||Object.values(x).some(function(a){return a.loading});return((0,B.useEffect)(function(){c&&u()},[c,u]),c)?(0,m.jsx)(q.Z,{className:"h-100 bg-dark",children:(0,m.jsx)(r.Z,{children:(0,m.jsxs)(s.Z,{children:[(0,m.jsx)(q.Z,{children:(0,m.jsx)(r.Z,{md:12,className:"my-1 px-4 py-3",style:{backgroundColor:"#33353e"},children:(0,m.jsxs)("h2",{className:"searchTitle",children:[b("Search Results for"),": ",d.query.q]})})}),y&&(0,m.jsx)(q.Z,{children:(0,m.jsx)(r.Z,{children:(0,m.jsx)(A.Z,{className:"mx-auto my-2"})})}),v&&Object.entries(a).map(function(e){var d=(0,k.Z)(e,2),b=d[0],f=d[1];return a[b]&&(0,m.jsx)(I,(0,j.Z)((0,i.Z)({search:c,category:b},f,v[b]),{setLoading:function(a,b){return z((0,j.Z)((0,i.Z)({},x),(0,h.Z)({},a,b)))}}),b)})]})})}):null}function I(a){var j=a.count,l=a.title,n=a.items,D=a.type,G=a.search,H=a.category,s=a.query,I=a.setLoading,c=(0,B.useState)(!1),J=c[0],K=c[1],d=(0,B.useState)(n),A=d[0],L=d[1],e=(0,B.useState)(0),f=e[0],M=e[1],g=(0,B.useState)(j),b=g[0],N=g[1],C=(0,k.Z)((0,p.t)((0,o.Ps)(E(),F,s),{onCompleted:function(a){I(H,!1),L(a.result.items)},onError:function(a){console.log(a),x.Am.error("Failed to fetch some results"),N(0)}}),1),O=C[0],h=30*f,i=h+30;return(0,B.useEffect)(function(){J?(I(H,!0),O({variables:{title:G,limit:30,page:f}})):K(!0)},[f]),b>0?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(q.Z,{className:"mb-1 mt-4",children:[(0,m.jsx)(r.Z,{md:"auto",children:(0,m.jsxs)("h2",{children:[l," (",b>30?"".concat(h+1," - ").concat(b<i?b:i):b,")"]})}),b>30&&(0,m.jsx)(r.Z,{md:"auto",children:(0,m.jsx)(t.Z,{children:Array.from(Array(Math.ceil(b/30)),function(b,a){return(0,m.jsx)(t.Z.Link,{disabled:f===a,onClick:function(){return M(a)},className:"py-0 px-2",children:(0,m.jsx)("h2",{children:a+1})},a)})})})]}),(0,m.jsx)(q.Z,{children:A.map(function(a){return(0,m.jsx)(r.Z,{md:6,children:(0,m.jsx)(w(),{href:"/".concat(D,"/").concat(a.id),children:(0,m.jsx)("a",{className:y().a,children:(0,m.jsxs)(q.Z,{className:u()(y().result,"mx-1 d-flex flex-row mb-3"),children:[D&&(0,m.jsx)(r.Z,{md:"auto",className:u()(y().cover,"px-0"),children:(0,m.jsx)(v(),{objectFit:"contain",alt:a.title,src:(0,z.Jn)(a.id,D),width:180,height:180,placeholder:"blur",blurDataURL:a.placeholder})}),(0,m.jsxs)(r.Z,{className:"p-2 px-4 my-auto",children:[(0,m.jsx)("h2",{children:a.title}),a.releaseDate&&(0,m.jsx)("p",{className:"card-text mt-2",children:a.releaseDate})]})]})})})},a.id)})})]}):null}}},function(a){a.O(0,[774,888,179],function(){var b;return a(a.s=2252)}),_N_E=a.O()}])