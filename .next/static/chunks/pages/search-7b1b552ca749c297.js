(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{2252:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/search",function(){return c(5935)}])},5935:function(g,b,a){"use strict";a.r(b),a.d(b,{"__N_SSP":function(){return H},default:function(){return I}});var h=a(5893),i=a(1163),j=a(7283),k=a(3359),l=a(1608),m=a(1555),n=a(682),o=a(9368),c=a(4184),p=a.n(c),d=a(5675),q=a.n(d),e=a(1664),r=a.n(e),s=a(782),f=a(3920),t=a.n(f),u=a(599),v=a(9738),w=a(7294),x=a(6974);function y(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function z(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function A(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){z(d,a,c[a])})}return d}function B(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}(a,b)||D(a,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(b,a){return a||(a=b.slice(0)),Object.freeze(Object.defineProperties(b,{raw:{value:Object.freeze(a)}}))}function D(a,c){if(a){if("string"==typeof a)return y(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return y(a,c)}}function E(){var a=C(["\n  ","{\n    byTitle: ","\n    byArtist: ","\n    games: ","\n    studios: ","\n    anims: ","\n    series: ","\n  }\n  "]);return E=function(){return a},a}function F(){var a=C(["\n      ","{\n        result: ","\n      }\n    "]);return F=function(){return a},a}var G="query Search($title: String!, $limit: Int!, $page: Int!)",H=!0;function I(){var b=(0,x.Z)(),d=(0,i.useRouter)(),c=d.query.q,a={byTitle:{query:"searchAlbum(title: $title, limit: $limit, page: $page){ count, items: rows { id, title, classes { name }, releaseDate, placeholder } }",title:b("Albums"),type:"album"},byArtist:{query:"searchAlbumByArtist(name: $title, limit: $limit, page: $page){ count, items: rows { id, title, classes { name }, releaseDate, placeholder } }",title:"".concat(b("Albums")," (","by artists",")"),type:"album"},games:{query:"searchGame(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name, releaseDate, placeholder } }",title:b("Games"),type:"game"},studios:{query:"searchStudio(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name } }",title:b("Studios")},anims:{query:"searchAnimation(title: $title, limit: $limit, page: $page){ count, items: rows { id, title, releaseDate, placeholder } }",title:b("Animations"),type:"anim"},series:{query:"searchSeries(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name, placeholder } }",title:b("Series"),type:"series"}},o={};Object.keys(a).forEach(function(a){o[a]=!1});var p=(0,j.Ps)(E(),G,a.byTitle.query,a.byArtist.query,a.games.query,a.studios.query,a.anims.query,a.series.query),e=B((0,k.t)(p,{variables:{title:c,limit:30,page:0}}),2),q=e[0],f=e[1],r=f.data,s=f.loading,g=(0,w.useState)(o),t=g[0],y=g[1],u=s||Object.values(t).some(function(a){return a.loading});return((0,w.useEffect)(function(){c&&q()},[c,q]),c)?(0,h.jsx)(l.Z,{className:"h-100 bg-dark",children:(0,h.jsx)(m.Z,{children:(0,h.jsxs)(n.Z,{children:[(0,h.jsx)(l.Z,{children:(0,h.jsx)(m.Z,{md:12,className:"my-1 px-4 py-3",style:{backgroundColor:"#33353e"},children:(0,h.jsxs)("h2",{className:"searchTitle",children:[b("Search Results for"),": ",d.query.q]})})}),u&&(0,h.jsx)(l.Z,{children:(0,h.jsx)(m.Z,{children:(0,h.jsx)(v.Z,{className:"mx-auto my-2"})})}),r&&Object.entries(a).map(function(e){var d=B(e,2),b=d[0],f=d[1];return a[b]&&(0,h.jsx)(J,A({search:c,category:b},f,r[b],{setLoading:function(a,b){return y(A({},t,z({},a,b)))}}),b)})]})})}):null}function J(a){var v=a.count,x=a.title,y=a.items,D=a.type,E=a.search,H=a.category,z=a.query,I=a.setLoading,c=(0,w.useState)(!1),J=c[0],K=c[1],d=(0,w.useState)(y),A=d[0],L=d[1],e=(0,w.useState)(0),f=e[0],M=e[1],g=(0,w.useState)(v),b=g[0],N=g[1],C=B((0,k.t)((0,j.Ps)(F(),G,z),{onCompleted:function(a){I(H,!1),L(a.result.items)},onError:function(a){console.log(a),s.Am.error("Failed to fetch some results"),N(0)}}),1),O=C[0],i=30*f,n=i+30;return(0,w.useEffect)(function(){J?(I(H,!0),O({variables:{title:E,limit:30,page:f}})):K(!0)},[f]),b>0?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(l.Z,{className:"mb-1 mt-4",children:[(0,h.jsx)(m.Z,{md:"auto",children:(0,h.jsxs)("h2",{children:[x," (",b>30?"".concat(i+1," - ").concat(b<n?b:n):b,")"]})}),b>30&&(0,h.jsx)(m.Z,{md:"auto",children:(0,h.jsx)(o.Z,{children:Array.from(Array(Math.ceil(b/30)),function(b,a){return(0,h.jsx)(o.Z.Link,{disabled:f===a,onClick:function(){return M(a)},className:"py-0 px-2",children:(0,h.jsx)("h2",{children:a+1})},a)})})})]}),(0,h.jsx)(l.Z,{children:A.map(function(a){return(0,h.jsx)(r(),{href:"/".concat(D,"/").concat(a.id),passHref:!0,children:(0,h.jsx)(m.Z,{md:6,children:(0,h.jsxs)(l.Z,{className:p()(t().result,"mx-1 d-flex flex-row mb-3"),children:[D&&(0,h.jsx)(m.Z,{md:"auto",className:p()(t().cover,"px-0"),children:(0,h.jsx)(q(),{objectFit:"contain",alt:a.title,src:(0,u.Jn)(a.id,D),width:180,height:180,placeholder:"blur",blurDataURL:a.placeholder})}),(0,h.jsxs)(m.Z,{className:"p-2 px-4 my-auto",children:[(0,h.jsx)("h2",{children:a.title}),a.releaseDate&&(0,h.jsx)("p",{className:"card-text mt-2",children:a.releaseDate})]})]})})},a.id)})})]}):null}}},function(a){a.O(0,[774,888,179],function(){return a(a.s=2252)}),_N_E=a.O()}])