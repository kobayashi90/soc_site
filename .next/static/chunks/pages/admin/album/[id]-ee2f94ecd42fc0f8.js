(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[216],{7612:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/album/[id]",function(){return n(6947)}])},6947:function(e,s,n){"use strict";n.r(s),n.d(s,{__N_SSP:function(){return C},default:function(){return T}});var t=n(7568),r=n(6042),a=n(828),l=n(7297),i=n(655),c=n(5893),d=n(7294),u=n(7283),o=n(319),m=n(1641),h=n(3359),x=n(682),j=n(4051),f=n(1555),Z=n(2878),b=n(4716),p=n(782),g=n(2045),$=n(4978),v=n(7065),y=n(1292),S=n(1331),w=n(5994),D=n(5043);function N(){var e=(0,l.Z)(["\nquery downloads ($id: ID!) {\n  downloads(id: $id) {\n    id\n    title\n    small\n    links {\n      id\n      url\n      provider\n      custom\n      directUrl\n    }\n  }\n}\n"]);return N=function(){return e},e}function _(){var e=(0,l.Z)(["\n    mutation updateAlbum(\n      $id: ID!,\n      $title: String,\n      $subTitle: String,\n      $cover: Upload,\n      $releaseDate: String,\n      $label: String,\n      $description: String,\n      $downloads: [DownloadInput],\n      $artists: [String],\n      $categories: [String],\n      $classifications: [String],\n      $platforms: [ID],\n      $games: [String],\n      $animations: [ID],\n      $discs: [DiscInput],\n      $related: [ID],\n      $stores: [StoreInput],\n      $vgmdb: String,\n      $status: String!,\n      $request: ID\n    ){\n      updateAlbum(\n        id: $id,\n        title: $title,\n        subTitle: $subTitle,\n        cover: $cover,\n        releaseDate: $releaseDate,\n        label: $label,\n        description: $description,\n        downloads: $downloads,\n        artists: $artists,\n        categories: $categories,\n        classifications: $classifications,\n        platforms: $platforms,\n        games: $games,\n        animations: $animations\n        discs: $discs,\n        related: $related,\n        stores: $stores,\n        vgmdb: $vgmdb,\n        status: $status,\n        request: $request\n      ){ id }\n    } \n  "]);return _=function(){return e},e}function L(){var e=(0,l.Z)(["\n  query ($search: String!){\n    vgmdb(search: $search){\n      vgmdbUrl\n      name\n      subTitle\n      releaseDate\n      artists\n      categories\n      classifications\n      tracklist {\n        number\n        body\n      }\n    }\n  }\n"]);return L=function(){return e},e}var F=(0,u.Ps)(N()),G=(0,u.Ps)(_()),V=(0,u.Ps)(L()),C=!0;function T(e){return(0,c.jsx)(x.Z,{fluid:!0,children:(0,c.jsxs)(j.Z,{children:[(0,c.jsx)(f.Z,{xs:2,children:(0,c.jsx)($.W_,{title:"Edit"})}),(0,c.jsxs)(f.Z,{xs:10,children:[(0,c.jsx)(k,(0,r.Z)({},e)),(0,c.jsx)($.sH,{})]})]})})}function k(e){var s,n=e.id,r=e.album,l=e.categories,u=e.classifications,x=function(e){e.persist(),e.preventDefault();var s=(0,S.ar)(e);s.id=r.id,P({mutation:G,variables:s}).then(function(e){p.Am.success('Updated "'.concat(s.title,'" succesfully!'))}).catch(function(e){console.log(e),p.Am.error(e.message,{autoclose:!1})})},N=(0,d.useState)(r.categories||[]),_=N[0],L=N[1],C=(0,d.useState)(r.classifications||[]),T=C[0],k=C[1],q=(0,d.useState)(r.discs||[]),I=q[0],A=q[1],E=(0,a.Z)((0,o.D)(G),2),P=E[0],R=E[1].loading,U=(0,y.Z)().user,H=(0,m.a)(F,{variables:{id:n}}),O=H.data,X=H.refetch;(0,d.useEffect)(function(){return X({id:n})},[U,n,X]);var J=(0,a.Z)((0,h.t)(V),2),M=J[0],Q=J[1].loading,W=(0,d.useRef)(null),z=(0,d.useRef)(null),B=(0,d.useRef)(null),K=(0,d.useRef)(null),Y=(0,d.useRef)(null);function ee(){return(ee=(0,t.Z)(function(){var e,s,n,t,r,a,l,c,d,u;return(0,i.__generator)(this,function(i){switch(i.label){case 0:return[4,M({variables:{search:B.current.value}})];case 1:return(null==(e=i.sent().data)?void 0:e.vgmdb)&&(n=(s=e.vgmdb).vgmdbUrl,t=s.name,r=s.subTitle,a=s.releaseDate,l=s.artists,c=s.categories,d=s.classifications,u=s.tracklist,z.current.value=a,B.current.value=n,W.current.value=t,K.current.value=r,Y.current.value=l.join(","),L(c),k(d),A(u)),[2]}})})).apply(this,arguments)}return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{id:"addAlbum",className:"mb-2 mt-3",children:["Editing ",'"'.concat(r.title,'"')," (",r.id,")"]}),(0,c.jsxs)(Z.Z,{className:"site-form blackblock",onSubmit:x,children:[(0,c.jsxs)(j.Z,{children:[(0,c.jsx)(f.Z,{md:3,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"title",children:"Title:"}),(0,c.jsx)(b.Z,{ref:W,h:!0,required:!0,type:"text",name:"title",defaultValue:r.title})]})}),(0,c.jsx)(f.Z,{md:3,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"subTitle",children:"Sub Title:"}),(0,c.jsx)(b.Z,{ref:K,as:"textarea",name:"subTitle",defaultValue:r.subTitle})]})}),(0,c.jsx)(f.Z,{md:3,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"releaseDate",children:"Release Date:"}),(0,c.jsx)(b.Z,{ref:z,required:!0,type:"date",name:"releaseDate",defaultValue:r.releaseDate})]})}),(0,c.jsx)(f.Z,{md:3,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"label",children:"Label:"}),(0,c.jsx)(b.Z,{type:"text",name:"label",defaultValue:r.label})]})})]}),(0,c.jsx)(j.Z,{className:"mb-3",children:(0,c.jsx)(f.Z,{children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"status",children:"Status:"}),(0,c.jsx)(g.d7,{isSingle:!0,required:!0,name:"status",defaultValue:{value:r.status,label:"string"!=typeof(s=r.status)?"":s.charAt(0).toUpperCase()+s.slice(1)},options:["Show","Hidden","Coming"].map(function(e){return{label:e,value:e.toLowerCase()}})})]})})}),(0,c.jsxs)(j.Z,{className:"mb-3",children:[(0,c.jsx)(f.Z,{md:6,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"title",children:"Description:"}),(0,c.jsx)(b.Z,{as:"textarea",name:"description",defaultValue:r.description})]})}),(0,c.jsx)(f.Z,{md:6,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"cover",children:"Cover:"}),(0,c.jsx)(b.Z,{name:"cover",type:"file",accept:"image/*"})]})})]}),(0,c.jsxs)(j.Z,{children:[(0,c.jsx)(f.Z,{md:6,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"vgmdb",children:"VGMdb:"}),(0,c.jsx)(b.Z,{ref:B,defaultValue:r.vgmdb,name:"vgmdb",type:"text"})]})}),(0,c.jsx)(f.Z,{className:"mt-auto",children:(0,c.jsx)(D.l,{color:"primary",loading:Q,onClick:function(){return ee.apply(this,arguments)},children:"Fetch info"})}),(0,c.jsx)(f.Z,{})]}),(0,c.jsx)("hr",{className:"style2 style-white"}),(0,c.jsxs)(j.Z,{className:"mb-3",children:[(0,c.jsx)(f.Z,{md:4,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"artists",children:"Artists:"}),(0,c.jsx)(b.Z,{ref:Y,name:"artists",as:"textarea",defaultValue:r.artists.map(function(e){return e.name}).join(",")})]})}),(0,c.jsx)(f.Z,{md:4,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"categories",children:"Categories:"}),(0,c.jsx)(g.d7,{defaultValue:r.categories,required:!0,name:"categories",options:l,onChange:function(e){return L(e)}})]})}),(0,c.jsx)(f.Z,{md:4,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"classifications",children:"Classifications:"}),(0,c.jsx)(g.d7,{required:!0,name:"classifications",defaultValue:T,options:u,onChange:function(e){return k(e)}})]})})]}),(0,c.jsx)("hr",{className:"style2 style-white"}),(0,c.jsxs)(j.Z,{children:[(0,c.jsx)(f.Z,{md:4,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"games",children:"Games:"}),(0,c.jsx)(g.D_,{options:{defaultValue:r.games,name:"games"}})]})}),(0,c.jsx)(f.Z,{md:4,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"platforms",children:"Platforms:"}),(0,c.jsx)(g.J3,{categories:_.map(function(e){return e.value}),options:{defaultValue:r.platforms,name:"platforms"}})]})}),(0,c.jsx)(f.Z,{md:4,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"animations",children:"Animations:"}),(0,c.jsx)(g.S7,{options:{defaultValue:r.animations,name:"animations"}})]})})]}),(0,c.jsx)("hr",{className:"style2 style-white"}),(0,c.jsx)(j.Z,{children:(0,c.jsx)(f.Z,{md:12,children:(0,c.jsxs)(Z.Z.Group,{children:[(0,c.jsx)(Z.Z.Label,{htmlFor:"related",children:"Related albums:"}),(0,c.jsx)(g.Q$,{options:{defaultValue:r.related,name:"related"}})]})})}),(0,c.jsx)("hr",{className:"style2 style-white"}),(0,c.jsx)($.r8,{defaults:I}),(0,c.jsx)("hr",{className:"style2 style-white"}),(0,c.jsx)($.rL,{defaults:r.stores}),(0,c.jsx)("hr",{className:"style2 style-white"}),(0,c.jsx)(w.Z,{element:B.current}),(0,c.jsx)("hr",{className:"style2 style-white"}),O&&(0,c.jsx)($.ie,{defaults:O.downloads}),(0,c.jsx)(j.Z,{children:(0,c.jsx)(f.Z,{className:"m-auto",children:(0,c.jsx)(v.Z,{loading:R,type:"submit",color:"primary",children:"Save Changes"})})})]})]})}}},function(e){e.O(0,[978,774,888,179],function(){return e(e.s=7612)}),_N_E=e.O()}]);