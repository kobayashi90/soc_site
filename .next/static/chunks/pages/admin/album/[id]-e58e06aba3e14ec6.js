(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[216],{7612:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/album/[id]",function(){return c(6947)}])},6947:function(h,c,a){"use strict";a.r(c),a.d(c,{"__N_SSP":function(){return I},default:function(){return J}});var i=a(7568),j=a(6042),k=a(828),l=a(7297),d=a(4051),m=a.n(d),n=a(5893),o=a(7294),b=a(7283),p=a(319),q=a(7887),r=a(3359),s=a(682),t=a(1608),u=a(1555),v=a(2878),w=a(4716),x=a(782),y=a(2045),z=a(4978),A=a(7065),B=a(1292),C=a(1331),D=a(5994),E=a(5043);function e(){var a=(0,l.Z)(["\nquery downloads ($id: ID!) {\n  downloads(id: $id) {\n    id\n    title\n    small\n    links {\n      id\n      url\n      provider\n      custom\n      directUrl\n    }\n  }\n}\n"]);return e=function(){return a},a}function f(){var a=(0,l.Z)(["\n    mutation updateAlbum(\n      $id: ID!,\n      $title: String,\n      $subTitle: String,\n      $cover: Upload,\n      $releaseDate: String,\n      $label: String,\n      $description: String,\n      $downloads: [DownloadInput],\n      $artists: [String],\n      $categories: [String],\n      $classifications: [String],\n      $platforms: [ID],\n      $games: [String],\n      $animations: [ID],\n      $discs: [DiscInput],\n      $related: [ID],\n      $stores: [StoreInput],\n      $vgmdb: String,\n      $status: String!,\n      $request: ID\n    ){\n      updateAlbum(\n        id: $id,\n        title: $title,\n        subTitle: $subTitle,\n        cover: $cover,\n        releaseDate: $releaseDate,\n        label: $label,\n        description: $description,\n        downloads: $downloads,\n        artists: $artists,\n        categories: $categories,\n        classifications: $classifications,\n        platforms: $platforms,\n        games: $games,\n        animations: $animations\n        discs: $discs,\n        related: $related,\n        stores: $stores,\n        vgmdb: $vgmdb,\n        status: $status,\n        request: $request\n      ){ id }\n    } \n  "]);return f=function(){return a},a}function g(){var a=(0,l.Z)(["\n  query ($search: String!){\n    vgmdb(search: $search){\n      vgmdbUrl\n      name\n      subTitle\n      releaseDate\n      artists\n      categories\n      classifications\n      tracklist {\n        number\n        body\n      }\n    }\n  }\n"]);return g=function(){return a},a}var F=(0,b.Ps)(e()),G=(0,b.Ps)(f()),H=(0,b.Ps)(g()),I=!0;function J(a){return(0,n.jsx)(s.Z,{fluid:!0,children:(0,n.jsxs)(t.Z,{children:[(0,n.jsx)(u.Z,{xs:2,children:(0,n.jsx)(z.W_,{title:"Edit"})}),(0,n.jsxs)(u.Z,{xs:10,children:[(0,n.jsx)(K,(0,j.Z)({},a)),(0,n.jsx)(z.sH,{})]})]})})}function K(b){var c,d=b.id,a=b.album,J=b.categories,K=b.classifications,e=(0,o.useState)(a.categories||[]),L=e[0],X=e[1],f=(0,o.useState)(a.classifications||[]),M=f[0],Y=f[1],g=(0,o.useState)(a.discs||[]),N=g[0],Z=g[1],h=(0,k.Z)((0,p.D)(G),2),$=h[0],O=h[1].loading,P=(0,B.Z)().user,j=(0,q.a)(F,{variables:{id:d}}),l=j.data,Q=j.refetch;(0,o.useEffect)(function(){return Q({id:d})},[P,d,Q]);var s=(0,k.Z)((0,r.t)(H),2),_=s[0],R=s[1],S=R.loading,T=(0,o.useRef)(null),U=(0,o.useRef)(null),I=(0,o.useRef)(null),V=(0,o.useRef)(null),W=(0,o.useRef)(null);function aa(){return(aa=(0,i.Z)(m().mark(function a(){var b,c,d,e,f,g,h,i,j,k;return m().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,_({variables:{search:I.current.value}});case 2:(null==(b=a.sent.data)?void 0:b.vgmdb)&&(d=(c=b.vgmdb).vgmdbUrl,e=c.name,f=c.subTitle,g=c.releaseDate,h=c.artists,i=c.categories,j=c.classifications,k=c.tracklist,U.current.value=g,I.current.value=d,T.current.value=e,V.current.value=f,W.current.value=h.join(","),X(i),Y(j),Z(k));case 4:case"end":return a.stop()}},a)}))).apply(this,arguments)}return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{id:"addAlbum",className:"mb-2 mt-3",children:["Editing ",'"'.concat(a.title,'"')," (",a.id,")"]}),(0,n.jsxs)(v.Z,{className:"site-form blackblock",onSubmit:function(b){b.persist(),b.preventDefault();var c=(0,C.ar)(b);c.id=a.id,$({mutation:G,variables:c}).then(function(a){x.Am.success('Updated "'.concat(c.title,'" succesfully!'))}).catch(function(a){console.log(a),x.Am.error(a.message,{autoclose:!1})})},children:[(0,n.jsxs)(t.Z,{children:[(0,n.jsx)(u.Z,{md:3,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"title",children:"Title:"}),(0,n.jsx)(w.Z,{ref:T,h:!0,required:!0,type:"text",name:"title",defaultValue:a.title})]})}),(0,n.jsx)(u.Z,{md:3,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"subTitle",children:"Sub Title:"}),(0,n.jsx)(w.Z,{ref:V,as:"textarea",name:"subTitle",defaultValue:a.subTitle})]})}),(0,n.jsx)(u.Z,{md:3,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"releaseDate",children:"Release Date:"}),(0,n.jsx)(w.Z,{ref:U,required:!0,type:"date",name:"releaseDate",defaultValue:a.releaseDate})]})}),(0,n.jsx)(u.Z,{md:3,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"label",children:"Label:"}),(0,n.jsx)(w.Z,{type:"text",name:"label",defaultValue:a.label})]})})]}),(0,n.jsx)(t.Z,{className:"mb-3",children:(0,n.jsx)(u.Z,{children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"status",children:"Status:"}),(0,n.jsx)(y.d7,{isSingle:!0,required:!0,name:"status",defaultValue:{value:a.status,label:"string"!=typeof(c=a.status)?"":c.charAt(0).toUpperCase()+c.slice(1)},options:["Show","Hidden","Coming"].map(function(a){return{label:a,value:a.toLowerCase()}})})]})})}),(0,n.jsxs)(t.Z,{className:"mb-3",children:[(0,n.jsx)(u.Z,{md:6,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"title",children:"Description:"}),(0,n.jsx)(w.Z,{as:"textarea",name:"description",defaultValue:a.description})]})}),(0,n.jsx)(u.Z,{md:6,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"cover",children:"Cover:"}),(0,n.jsx)(w.Z,{name:"cover",type:"file",accept:"image/*"})]})})]}),(0,n.jsxs)(t.Z,{children:[(0,n.jsx)(u.Z,{md:6,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"vgmdb",children:"VGMdb:"}),(0,n.jsx)(w.Z,{ref:I,defaultValue:a.vgmdb,name:"vgmdb",type:"text"})]})}),(0,n.jsx)(u.Z,{className:"mt-auto",children:(0,n.jsx)(E.l,{color:"primary",loading:S,onClick:function(){return aa.apply(this,arguments)},children:"Fetch info"})}),(0,n.jsx)(u.Z,{})]}),(0,n.jsx)("hr",{className:"style2 style-white"}),(0,n.jsxs)(t.Z,{className:"mb-3",children:[(0,n.jsx)(u.Z,{md:4,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"artists",children:"Artists:"}),(0,n.jsx)(w.Z,{ref:W,name:"artists",as:"textarea",defaultValue:a.artists.map(function(a){return a.name}).join(",")})]})}),(0,n.jsx)(u.Z,{md:4,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"categories",children:"Categories:"}),(0,n.jsx)(y.d7,{defaultValue:a.categories,required:!0,name:"categories",options:J,onChange:function(a){return X(a)}})]})}),(0,n.jsx)(u.Z,{md:4,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"classifications",children:"Classifications:"}),(0,n.jsx)(y.d7,{required:!0,name:"classifications",defaultValue:M,options:K,onChange:function(a){return Y(a)}})]})})]}),(0,n.jsx)("hr",{className:"style2 style-white"}),(0,n.jsxs)(t.Z,{children:[(0,n.jsx)(u.Z,{md:4,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"games",children:"Games:"}),(0,n.jsx)(y.D_,{options:{defaultValue:a.games,name:"games"}})]})}),(0,n.jsx)(u.Z,{md:4,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"platforms",children:"Platforms:"}),(0,n.jsx)(y.J3,{categories:L.map(function(a){return a.value}),options:{defaultValue:a.platforms,name:"platforms"}})]})}),(0,n.jsx)(u.Z,{md:4,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"animations",children:"Animations:"}),(0,n.jsx)(y.S7,{options:{defaultValue:a.animations,name:"animations"}})]})})]}),(0,n.jsx)("hr",{className:"style2 style-white"}),(0,n.jsx)(t.Z,{children:(0,n.jsx)(u.Z,{md:12,children:(0,n.jsxs)(v.Z.Group,{children:[(0,n.jsx)(v.Z.Label,{htmlFor:"related",children:"Related OSTs:"}),(0,n.jsx)(y.Q$,{options:{defaultValue:a.related,name:"related"}})]})})}),(0,n.jsx)("hr",{className:"style2 style-white"}),(0,n.jsx)(z.r8,{defaults:N}),(0,n.jsx)("hr",{className:"style2 style-white"}),(0,n.jsx)(z.rL,{defaults:a.stores}),(0,n.jsx)("hr",{className:"style2 style-white"}),(0,n.jsx)(D.Z,{element:I.current}),(0,n.jsx)("hr",{className:"style2 style-white"}),l&&(0,n.jsx)(z.ie,{defaults:l.downloads}),(0,n.jsx)(t.Z,{children:(0,n.jsx)(u.Z,{className:"m-auto",children:(0,n.jsx)(A.Z,{loading:O,type:"submit",color:"primary",children:"Save Changes"})})})]})]})}}},function(a){a.O(0,[45,683,774,888,179],function(){var b;return a(a.s=7612)}),_N_E=a.O()}])