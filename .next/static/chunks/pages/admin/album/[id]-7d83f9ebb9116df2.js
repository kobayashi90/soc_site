(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[216],{7612:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/album/[id]",function(){return c(6947)}])},6947:function(a,b,c){"use strict";c.r(b),c.d(b,{"__N_SSP":function(){return I},default:function(){return J}});var d=c(7568),e=c(6042),f=c(828),g=c(7297),h=c(4051),i=c.n(h),j=c(5893),k=c(7294),l=c(7283),m=c(319),n=c(7887),o=c(3359),p=c(682),q=c(1608),r=c(1555),s=c(2878),t=c(4716),u=c(782),v=c(2045),w=c(4978),x=c(7065),y=c(1292),z=c(1331),A=c(5994),B=c(5043);function C(){var a=(0,g.Z)(["\nquery downloads ($id: ID!) {\n  downloads(id: $id) {\n    id\n    title\n    small\n    links {\n      id\n      url\n      provider\n      custom\n      directUrl\n    }\n  }\n}\n"]);return C=function(){return a},a}function D(){var a=(0,g.Z)(["\n    mutation updateAlbum(\n      $id: ID!,\n      $title: String,\n      $subTitle: String,\n      $cover: Upload,\n      $releaseDate: String,\n      $label: String,\n      $description: String,\n      $downloads: [DownloadInput],\n      $artists: [String],\n      $categories: [String],\n      $classifications: [String],\n      $platforms: [ID],\n      $games: [String],\n      $animations: [ID],\n      $discs: [DiscInput],\n      $related: [ID],\n      $stores: [StoreInput],\n      $vgmdb: String,\n      $status: String!,\n      $request: ID\n    ){\n      updateAlbum(\n        id: $id,\n        title: $title,\n        subTitle: $subTitle,\n        cover: $cover,\n        releaseDate: $releaseDate,\n        label: $label,\n        description: $description,\n        downloads: $downloads,\n        artists: $artists,\n        categories: $categories,\n        classifications: $classifications,\n        platforms: $platforms,\n        games: $games,\n        animations: $animations\n        discs: $discs,\n        related: $related,\n        stores: $stores,\n        vgmdb: $vgmdb,\n        status: $status,\n        request: $request\n      ){ id }\n    } \n  "]);return D=function(){return a},a}function E(){var a=(0,g.Z)(["\n  query ($search: String!){\n    vgmdb(search: $search){\n      vgmdbUrl\n      name\n      subTitle\n      releaseDate\n      artists\n      categories\n      classifications\n      tracklist {\n        number\n        body\n      }\n    }\n  }\n"]);return E=function(){return a},a}var F=(0,l.Ps)(C()),G=(0,l.Ps)(D()),H=(0,l.Ps)(E()),I=!0;function J(a){return(0,j.jsx)(p.Z,{fluid:!0,children:(0,j.jsxs)(q.Z,{children:[(0,j.jsx)(r.Z,{xs:2,children:(0,j.jsx)(w.W_,{title:"Edit"})}),(0,j.jsxs)(r.Z,{xs:10,children:[(0,j.jsx)(K,(0,e.Z)({},a)),(0,j.jsx)(w.sH,{})]})]})})}function K(a){var b,c=a.id,e=a.album,g=a.categories,h=a.classifications,l=function(a){a.persist(),a.preventDefault();var b=(0,z.ar)(a);b.id=e.id,O({mutation:G,variables:b}).then(function(a){u.Am.success('Updated "'.concat(b.title,'" succesfully!'))}).catch(function(a){console.log(a),u.Am.error(a.message,{autoclose:!1})})},p=(0,k.useState)(e.categories||[]),C=p[0],D=p[1],E=(0,k.useState)(e.classifications||[]),I=E[0],J=E[1],K=(0,k.useState)(e.discs||[]),L=K[0],M=K[1],N=(0,f.Z)((0,m.D)(G),2),O=N[0],P=N[1].loading,Q=(0,y.Z)().user,R=(0,n.a)(F,{variables:{id:c}}),S=R.data,T=R.refetch;(0,k.useEffect)(function(){return T({id:c})},[Q,c,T]);var U=(0,f.Z)((0,o.t)(H),2),V=U[0],W=U[1],X=W.loading,Y=(0,k.useRef)(null),Z=(0,k.useRef)(null),$=(0,k.useRef)(null),_=(0,k.useRef)(null),aa=(0,k.useRef)(null);function ab(){return(ab=(0,d.Z)(i().mark(function a(){var b,c,d,e,f,g,h,j,k,l;return i().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,V({variables:{search:$.current.value}});case 2:(null==(b=a.sent.data)?void 0:b.vgmdb)&&(d=(c=b.vgmdb).vgmdbUrl,e=c.name,f=c.subTitle,g=c.releaseDate,h=c.artists,j=c.categories,k=c.classifications,l=c.tracklist,Z.current.value=g,$.current.value=d,Y.current.value=e,_.current.value=f,aa.current.value=h.join(","),D(j),J(k),M(l));case 4:case"end":return a.stop()}},a)}))).apply(this,arguments)}return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{id:"addAlbum",className:"mb-2 mt-3",children:["Editing ",'"'.concat(e.title,'"')," (",e.id,")"]}),(0,j.jsxs)(s.Z,{className:"site-form blackblock",onSubmit:l,children:[(0,j.jsxs)(q.Z,{children:[(0,j.jsx)(r.Z,{md:3,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"title",children:"Title:"}),(0,j.jsx)(t.Z,{ref:Y,h:!0,required:!0,type:"text",name:"title",defaultValue:e.title})]})}),(0,j.jsx)(r.Z,{md:3,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"subTitle",children:"Sub Title:"}),(0,j.jsx)(t.Z,{ref:_,as:"textarea",name:"subTitle",defaultValue:e.subTitle})]})}),(0,j.jsx)(r.Z,{md:3,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"releaseDate",children:"Release Date:"}),(0,j.jsx)(t.Z,{ref:Z,required:!0,type:"date",name:"releaseDate",defaultValue:e.releaseDate})]})}),(0,j.jsx)(r.Z,{md:3,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"label",children:"Label:"}),(0,j.jsx)(t.Z,{type:"text",name:"label",defaultValue:e.label})]})})]}),(0,j.jsx)(q.Z,{className:"mb-3",children:(0,j.jsx)(r.Z,{children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"status",children:"Status:"}),(0,j.jsx)(v.d7,{isSingle:!0,required:!0,name:"status",defaultValue:{value:e.status,label:"string"!=typeof(b=e.status)?"":b.charAt(0).toUpperCase()+b.slice(1)},options:["Show","Hidden","Coming"].map(function(a){return{label:a,value:a.toLowerCase()}})})]})})}),(0,j.jsxs)(q.Z,{className:"mb-3",children:[(0,j.jsx)(r.Z,{md:6,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"title",children:"Description:"}),(0,j.jsx)(t.Z,{as:"textarea",name:"description",defaultValue:e.description})]})}),(0,j.jsx)(r.Z,{md:6,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"cover",children:"Cover:"}),(0,j.jsx)(t.Z,{name:"cover",type:"file",accept:"image/*"})]})})]}),(0,j.jsxs)(q.Z,{children:[(0,j.jsx)(r.Z,{md:6,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"vgmdb",children:"VGMdb:"}),(0,j.jsx)(t.Z,{ref:$,defaultValue:e.vgmdb,name:"vgmdb",type:"text"})]})}),(0,j.jsx)(r.Z,{className:"mt-auto",children:(0,j.jsx)(B.l,{color:"primary",loading:X,onClick:function(){return ab.apply(this,arguments)},children:"Fetch info"})}),(0,j.jsx)(r.Z,{})]}),(0,j.jsx)("hr",{className:"style2 style-white"}),(0,j.jsxs)(q.Z,{className:"mb-3",children:[(0,j.jsx)(r.Z,{md:4,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"artists",children:"Artists:"}),(0,j.jsx)(t.Z,{ref:aa,name:"artists",as:"textarea",defaultValue:e.artists.map(function(a){return a.name}).join(",")})]})}),(0,j.jsx)(r.Z,{md:4,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"categories",children:"Categories:"}),(0,j.jsx)(v.d7,{defaultValue:e.categories,required:!0,name:"categories",options:g,onChange:function(a){return D(a)}})]})}),(0,j.jsx)(r.Z,{md:4,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"classifications",children:"Classifications:"}),(0,j.jsx)(v.d7,{required:!0,name:"classifications",defaultValue:I,options:h,onChange:function(a){return J(a)}})]})})]}),(0,j.jsx)("hr",{className:"style2 style-white"}),(0,j.jsxs)(q.Z,{children:[(0,j.jsx)(r.Z,{md:4,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"games",children:"Games:"}),(0,j.jsx)(v.D_,{options:{defaultValue:e.games,name:"games"}})]})}),(0,j.jsx)(r.Z,{md:4,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"platforms",children:"Platforms:"}),(0,j.jsx)(v.J3,{categories:C.map(function(a){return a.value}),options:{defaultValue:e.platforms,name:"platforms"}})]})}),(0,j.jsx)(r.Z,{md:4,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"animations",children:"Animations:"}),(0,j.jsx)(v.S7,{options:{defaultValue:e.animations,name:"animations"}})]})})]}),(0,j.jsx)("hr",{className:"style2 style-white"}),(0,j.jsx)(q.Z,{children:(0,j.jsx)(r.Z,{md:12,children:(0,j.jsxs)(s.Z.Group,{children:[(0,j.jsx)(s.Z.Label,{htmlFor:"related",children:"Related OSTs:"}),(0,j.jsx)(v.Q$,{options:{defaultValue:e.related,name:"related"}})]})})}),(0,j.jsx)("hr",{className:"style2 style-white"}),(0,j.jsx)(w.r8,{defaults:L}),(0,j.jsx)("hr",{className:"style2 style-white"}),(0,j.jsx)(w.rL,{defaults:e.stores}),(0,j.jsx)("hr",{className:"style2 style-white"}),(0,j.jsx)(A.Z,{element:$.current}),(0,j.jsx)("hr",{className:"style2 style-white"}),S&&(0,j.jsx)(w.ie,{defaults:S.downloads}),(0,j.jsx)(q.Z,{children:(0,j.jsx)(r.Z,{className:"m-auto",children:(0,j.jsx)(x.Z,{loading:P,type:"submit",color:"primary",children:"Save Changes"})})})]})]})}}},function(a){a.O(0,[45,683,774,888,179],function(){var b;return a(a.s=7612)}),_N_E=a.O()}])