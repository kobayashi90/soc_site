(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[476],{1365:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/request",function(){return n(5384)}])},5384:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return R},default:function(){return L}});var s=n(7297),r=n(5893),l=n(7294),a=n(682),i=n(1555),o=n(343),c=n(2878),d=n(4051),u=n(4716),h=n(2318),x=n(5147),j=n(7283),m=n(319),Z=n(1641),p=n(7422),f=n.n(p),v=n(782),b=n(4184),g=n.n(b),$=n(3907),k=n(9738),y=n(4495),N=n.n(y);function q(){let e=(0,s.Z)(["\n    mutation ($id: ID!, $reason: String){\n      rejectRequest(id: $id, reason: $reason)\n    }\n  "]);return q=function(){return e},e}function _(){let e=(0,s.Z)(["\n    mutation ($id: ID!, $title: String, $link: String, $state: String, $comments: String, $reason: String){\n      editRequest(id: $id, title: $title, link: $link, state: $state, comments: $comments, reason: $reason){\n        ","\n      }\n    }\n  "]);return _=function(){return e},e}function C(){let e=(0,s.Z)(["\n  query ($state: String!, $donator: [Boolean!]!) {\n    requests(state: [$state], donator: $donator) {\n      ","\n    }\n  }\n"]);return C=function(){return e},e}let S=["Complete","Pending","Hold"].map(e=>({label:e,value:e.toLowerCase()})),w=["Donators","Members"].map(e=>({label:e,value:"Donators"===e})),D="\n  id\n  title\n  link\n  user\n  userID\n  state\n  donator\n  reason\n  comments\n";var R=!0;function L(){return(0,r.jsx)(a.Z,{children:(0,r.jsx)(i.Z,{children:(0,r.jsx)(E,{})})})}function F(e){let{request:t,setRequest:n}=e,s=(0,j.Ps)(q()),a=(0,j.Ps)(_(),D),[h,{loading:x}]=(0,m.D)(s),[Z,{loading:p}]=(0,m.D)(a),b=(0,l.useRef)(null);return(0,r.jsxs)(o.Z,{show:t,onHide:()=>n(),centered:!0,children:[(0,r.jsx)(o.Z.Body,{children:(0,r.jsxs)(c.Z,{ref:b,children:[(0,r.jsx)(d.Z,{children:(0,r.jsxs)(c.Z.Group,{as:i.Z,children:[(0,r.jsx)(c.Z.Label,{htmlFor:"title",style:{color:"black"},children:"Title:"}),(0,r.jsx)(c.Z.Control,{required:!0,type:"text",name:"title",defaultValue:null==t?void 0:t.title})]})}),(0,r.jsxs)(d.Z,{className:"mt-3",children:[(0,r.jsxs)(c.Z.Group,{as:i.Z,children:[(0,r.jsx)(c.Z.Label,{htmlFor:"link",style:{color:"black"},children:"Link:"}),(0,r.jsx)(c.Z.Control,{required:!0,type:"text",name:"link",defaultValue:null==t?void 0:t.link})]}),(0,r.jsxs)(c.Z.Group,{as:i.Z,children:[(0,r.jsx)(c.Z.Label,{htmlFor:"state",style:{color:"black"},children:"Status:"}),(0,r.jsx)("select",{className:"form-control",name:"state",defaultValue:null==t?void 0:t.state,children:S.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,r.jsx)(d.Z,{className:"mt-3",children:(0,r.jsxs)(c.Z.Group,{as:i.Z,children:[(0,r.jsx)(c.Z.Label,{htmlFor:"comment",style:{color:"black"},defaultValue:null==t?void 0:t.comment,children:"Comments:"}),(0,r.jsx)(u.Z,{required:!0,as:"textarea",name:"comment"})]})}),(0,r.jsx)(d.Z,{className:"mt-3",children:(0,r.jsxs)(c.Z.Group,{as:i.Z,children:[(0,r.jsx)(c.Z.Label,{htmlFor:"reason",style:{color:"black"},defaultValue:null==t?void 0:t.reason,children:"Reason:"}),(0,r.jsx)(u.Z,{required:!0,as:"textarea",name:"reason"})]})})]})}),(0,r.jsxs)(o.Z.Footer,{children:[(0,r.jsx)(k.l,{loading:x,disabled:p,variant:"danger",onClick:function(){let e=b.current,s=f()(e,{hash:!0});s.id=t.id,h({variables:s}).then(t=>{v.Am.success("Request rejected succesfully!"),n(),e.reset()}).catch(e=>{console.log(e),v.Am.error(e.message,{autoclose:!1})})},children:"Reject"}),(0,r.jsx)(k.l,{loading:p,disabled:x,variant:"primary",onClick:function(){let e=b.current,s=f()(e,{hash:!0});s.id=t.id,Z({variables:s}).then(t=>{v.Am.success("Updated request succesfully!"),n(t.data.editRequest),e.reset()}).catch(e=>{console.log(e),v.Am.error(e.message,{autoclose:!1})})},children:"Save Changes"})]})]})}function E(){let[e,t]=(0,l.useState)(["pending"]),[n,s]=(0,l.useState)(w.map(e=>e.value)),[a,o]=(0,l.useState)(""),[x,j]=(0,l.useState)(),m=e=>{e.persist(),e.preventDefault(),o(e.target.value)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(F,{request:x,setRequest:j}),(0,r.jsxs)(c.Z,{className:"site-form blackblock mt-5 py-4",children:[(0,r.jsx)(d.Z,{className:"mb-3",children:(0,r.jsx)(i.Z,{children:(0,r.jsx)(c.Z.Group,{children:(0,r.jsxs)(h.Z,{children:[(0,r.jsx)(h.Z.Text,{children:"\uD83D\uDD0E"}),(0,r.jsx)(u.Z,{type:"text",onBlur:m,onKeyDown(e){"Enter"===e.key&&m(e)}})]})})})}),(0,r.jsxs)(d.Z,{className:"my-3",children:[(0,r.jsx)(i.Z,{md:"auto",children:(0,r.jsx)(c.Z.Label,{htmlFor:"status",children:"Status:"})}),(0,r.jsx)(i.Z,{children:(0,r.jsx)($.d7,{onChange:e=>t(e.map(e=>e.value)),required:!0,name:"status",defaultValue:[{label:"Pending",value:"pending"}],options:S})})]}),(0,r.jsxs)(d.Z,{className:"my-3",children:[(0,r.jsx)(i.Z,{md:"auto",children:(0,r.jsx)(c.Z.Label,{htmlFor:"status",children:"Users:"})}),(0,r.jsx)(i.Z,{children:(0,r.jsx)($.d7,{onChange:e=>s(e.map(e=>e.value)),required:!0,name:"users",defaultValue:w,options:w})})]}),e.map(e=>(0,r.jsx)(P,{state:e,users:n,search:a.toLowerCase(),setRequest:j},e))]})]})}function P(e){let{state:t,users:n,search:s,setRequest:l}=e,a="hold"===t,o=(0,j.Ps)(C(),D),{data:c,loading:u,error:h}=(0,Z.a)(o,{variables:{state:t,donator:n}});return h&&(console.log(h),v.Am.error("Failed to fetch requests")),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{className:"mt-4",children:(0,r.jsx)(i.Z,{children:(0,r.jsx)("h3",{className:"text-capitalize",children:t})})}),(0,r.jsx)(d.Z,{children:(0,r.jsx)(i.Z,{style:{height:"500px"},children:(0,r.jsxs)("div",{className:g()("overflow-auto h-100",N().table),children:[u&&(0,r.jsx)(k.Z,{dev:!0,className:"mx-auto"}),c&&(0,r.jsxs)(x.Z,{variant:"dark",hover:!0,responsive:!0,style:{overflowX:"visible"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Title"}),(0,r.jsx)("th",{children:"Link"}),(0,r.jsx)("th",{children:"User"}),(0,r.jsx)("th",{children:"Donator"}),a&&(0,r.jsx)("th",{children:"Reason"}),(0,r.jsx)("th",{children:"Comments"}),(0,r.jsx)("th",{})]})}),(0,r.jsx)("tbody",{children:(0,r.jsx)(function(){return c.requests.filter(e=>{let{title:t,link:n}=e;return(null==t?void 0:t.toLowerCase().includes(s))||(null==n?void 0:n.toLowerCase())===s}).map(e=>{let{id:t,title:n,link:s,user:i,userID:o,donator:c,reason:d,comments:u}=e;return(0,r.jsxs)("tr",{style:{cursor:"pointer"},onClick:()=>l(e),children:[(0,r.jsx)("td",{children:t}),(0,r.jsx)("td",{children:n}),(0,r.jsx)("td",{children:s}),(0,r.jsx)("td",{children:i||(o?"<@".concat(o,">"):"Not Found")}),(0,r.jsx)("td",{style:{textAlign:"center"},children:c?"⭐":""}),a&&(0,r.jsx)("td",{children:d}),(0,r.jsx)("td",{children:u})]},t)})},{})})]})]})})})]})}},4495:function(e){e.exports={table:"Request_table__Sr4vK",pagination:"Request_pagination__bcal1"}},2318:function(e,t,n){"use strict";var s=n(4184),r=n.n(s),l=n(7294),a=n(6611),i=n(6792),o=n(6558),c=n(3045),d=n(5893);let u=(0,a.Z)("input-group-text",{Component:"span"}),h=e=>(0,d.jsx)(u,{children:(0,d.jsx)(o.Z,{type:"checkbox",...e})}),x=e=>(0,d.jsx)(u,{children:(0,d.jsx)(o.Z,{type:"radio",...e})}),j=l.forwardRef(({bsPrefix:e,size:t,hasValidation:n,className:s,as:a="div",...o},u)=>{e=(0,i.vE)(e,"input-group");let h=(0,l.useMemo)(()=>({}),[]);return(0,d.jsx)(c.Z.Provider,{value:h,children:(0,d.jsx)(a,{ref:u,...o,className:r()(s,e,t&&`${e}-${t}`,n&&"has-validation")})})});j.displayName="InputGroup",t.Z=Object.assign(j,{Text:u,Radio:x,Checkbox:h})},5147:function(e,t,n){"use strict";var s=n(4184),r=n.n(s),l=n(7294),a=n(6792),i=n(5893);let o=l.forwardRef(({bsPrefix:e,className:t,striped:n,bordered:s,borderless:l,hover:o,size:c,variant:d,responsive:u,...h},x)=>{let j=(0,a.vE)(e,"table"),m=r()(t,j,d&&`${j}-${d}`,c&&`${j}-${c}`,n&&`${j}-striped`,s&&`${j}-bordered`,l&&`${j}-borderless`,o&&`${j}-hover`),Z=(0,i.jsx)("table",{...h,className:m,ref:x});if(u){let p=`${j}-responsive`;return"string"==typeof u&&(p=`${p}-${u}`),(0,i.jsx)("div",{className:p,children:Z})}return Z});t.Z=o}},function(e){e.O(0,[774,888,179],function(){return e(e.s=1365)}),_N_E=e.O()}]);