(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{2252:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/search",function(){return i(1025)}])},1025:function(e,t,i){"use strict";i.r(t),i.d(t,{__N_SSP:function(){return D},default:function(){return T}});var r=i(4924),s=i(6042),n=i(9396),a=i(828),l=i(7297),c=i(5893),u=i(1163),o=i(7283),m=i(3359),d=i(4051),h=i(1555),p=i(682),y=i(9368),f=i(4184),g=i.n(f),x=i(5675),j=i.n(x),Z=i(1664),b=i.n(Z),$=i(782),q=i(6666),N=i.n(q),_=i(1331),w=i(5043),S=i(7294),A=i(2729);function v(){var e=(0,l.Z)(["\n  ","{\n    byTitle: ","\n    byArtist: ","\n    games: ","\n    studios: ","\n    anims: ","\n    series: ","\n  }\n  "]);return v=function(){return e},e}function k(){var e=(0,l.Z)(["\n      ","{\n        result: ","\n      }\n    "]);return k=function(){return e},e}var E="query Search($title: String!, $limit: Int!, $page: Int!)",D=!0;function T(){var e=(0,A.Z)(),t=(0,u.useRouter)(),i=t.query.q,l={byTitle:{query:"searchAlbum(title: $title, limit: $limit, page: $page){ count, items: rows { id, title, categories { name }, releaseDate, placeholder } }",title:e("Albums"),type:"album"},byArtist:{query:"searchAlbumByArtist(name: $title, limit: $limit, page: $page){ count, items: rows { id, title, categories { name }, releaseDate, placeholder } }",title:"".concat(e("Albums")," (","by artists",")"),type:"album"},games:{query:"searchGame(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name, releaseDate, placeholder } }",title:e("Games"),type:"game"},studios:{query:"searchStudio(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name } }",title:e("Studios")},anims:{query:"searchAnimation(title: $title, limit: $limit, page: $page){ count, items: rows { id, title, releaseDate, placeholder } }",title:e("Animations"),type:"anim"},series:{query:"searchSeries(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name, placeholder } }",title:e("Series"),type:"series"}},y={};Object.keys(l).forEach(function(e){y[e]=!1});var f=(0,o.Ps)(v(),E,l.byTitle.query,l.byArtist.query,l.games.query,l.studios.query,l.anims.query,l.series.query),g=(0,a.Z)((0,m.t)(f,{variables:{title:i,limit:30,page:0}}),2),x=g[0],j=g[1],Z=j.data,b=j.loading,$=(0,S.useState)(y),q=$[0],N=$[1],_=function(e,t){return N((0,n.Z)((0,s.Z)({},q),(0,r.Z)({},e,t)))},k=b||Object.values(q).some(function(e){return e.loading});return((0,S.useEffect)(function(){i&&x()},[i,x]),i)?(0,c.jsx)(d.Z,{className:"h-100 bg-dark",children:(0,c.jsx)(h.Z,{children:(0,c.jsxs)(p.Z,{children:[(0,c.jsx)(d.Z,{children:(0,c.jsx)(h.Z,{md:12,className:"my-1 px-4 py-3",style:{backgroundColor:"#33353e"},children:(0,c.jsxs)("h2",{className:"searchTitle",children:[e("Search Results for"),": ",t.query.q]})})}),k&&(0,c.jsx)(d.Z,{children:(0,c.jsx)(h.Z,{children:(0,c.jsx)(w.Z,{className:"mx-auto my-2"})})}),Z&&Object.entries(l).map(function(e){var t=(0,a.Z)(e,2),r=t[0],u=t[1];return l[r]&&(0,c.jsx)(C,(0,n.Z)((0,s.Z)({search:i,category:r},u,Z[r]),{setLoading:_}),r)})]})})}):null}function C(e){var t=e.count,i=e.title,r=e.items,s=e.type,n=e.search,l=e.category,u=e.query,p=e.setLoading,f=(0,S.useState)(!1),x=f[0],Z=f[1],q=(0,S.useState)(r),w=q[0],A=q[1],v=(0,S.useState)(0),D=v[0],T=v[1],C=(0,S.useState)(t),O=C[0],P=C[1],L=(0,a.Z)((0,m.t)((0,o.Ps)(k(),E,u),{onCompleted:function(e){p(l,!1),A(e.result.items)},onError:function(e){console.log(e),$.Am.error("Failed to fetch some results"),P(0)}}),1)[0],F=30*D,R=F+30;return(0,S.useEffect)(function(){x?(p(l,!0),L({variables:{title:n,limit:30,page:D}})):Z(!0)},[D]),O>0?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(d.Z,{className:"mb-1 mt-4",children:[(0,c.jsx)(h.Z,{md:"auto",children:(0,c.jsxs)("h2",{children:[i," (",O>30?"".concat(F+1," - ").concat(O<R?O:R):O,")"]})}),O>30&&(0,c.jsx)(h.Z,{md:"auto",children:(0,c.jsx)(y.Z,{children:Array.from(Array(Math.ceil(O/30)),function(e,t){return(0,c.jsx)(y.Z.Link,{disabled:D===t,onClick:function(){return T(t)},className:"py-0 px-2",children:(0,c.jsx)("h2",{children:t+1})},t)})})})]}),(0,c.jsx)(d.Z,{children:w.map(function(e){return(0,c.jsx)(h.Z,{md:6,children:(0,c.jsx)(b(),{href:"/".concat(s,"/").concat(e.id),className:N().a,children:(0,c.jsxs)(d.Z,{className:g()(N().result,"mx-1 d-flex flex-row mb-3"),children:[s&&(0,c.jsx)(h.Z,{md:"auto",className:g()(N().cover,"px-0"),children:(0,c.jsx)(j(),{objectFit:"contain",alt:e.title,src:(0,_.Jn)(e.id,s),width:180,height:180,placeholder:"blur",blurDataURL:e.placeholder})}),(0,c.jsxs)(h.Z,{className:"p-2 px-4 my-auto",children:[(0,c.jsx)("h2",{children:e.title}),e.releaseDate&&(0,c.jsx)("p",{className:"card-text mt-2",children:e.releaseDate})]})]})})},e.id)})})]}):null}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=2252)}),_N_E=e.O()}]);