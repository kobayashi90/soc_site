(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{2252:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/search",function(){return c(1025)}])},1025:function(a,b,c){"use strict";c.r(b),c.d(b,{"__N_SSP":function(){return G},default:function(){return H}});var d=c(4924),e=c(6042),f=c(9396),g=c(828),h=c(7297),i=c(5893),j=c(1163),k=c(7283),l=c(3359),m=c(1608),n=c(1555),o=c(682),p=c(9368),q=c(4184),r=c.n(q),s=c(5675),t=c.n(s),u=c(1664),v=c.n(u),w=c(782),x=c(6666),y=c.n(x),z=c(1331),A=c(5043),B=c(7294),C=c(2729);function D(){var a=(0,h.Z)(["\n  ","{\n    byTitle: ","\n    byArtist: ","\n    games: ","\n    studios: ","\n    anims: ","\n    series: ","\n  }\n  "]);return D=function(){return a},a}function E(){var a=(0,h.Z)(["\n      ","{\n        result: ","\n      }\n    "]);return E=function(){return a},a}var F="query Search($title: String!, $limit: Int!, $page: Int!)",G=!0;function H(){var a=(0,C.Z)(),b=(0,j.useRouter)(),c=b.query.q,h={byTitle:{query:"searchAlbum(title: $title, limit: $limit, page: $page){ count, items: rows { id, title, categories { name }, releaseDate, placeholder } }",title:a("Albums"),type:"album"},byArtist:{query:"searchAlbumByArtist(name: $title, limit: $limit, page: $page){ count, items: rows { id, title, categories { name }, releaseDate, placeholder } }",title:"".concat(a("Albums")," (","by artists",")"),type:"album"},games:{query:"searchGame(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name, releaseDate, placeholder } }",title:a("Games"),type:"game"},studios:{query:"searchStudio(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name } }",title:a("Studios")},anims:{query:"searchAnimation(title: $title, limit: $limit, page: $page){ count, items: rows { id, title, releaseDate, placeholder } }",title:a("Animations"),type:"anim"},series:{query:"searchSeries(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name, placeholder } }",title:a("Series"),type:"series"}},p={};Object.keys(h).forEach(function(a){p[a]=!1});var q=(0,k.Ps)(D(),F,h.byTitle.query,h.byArtist.query,h.games.query,h.studios.query,h.anims.query,h.series.query),r=(0,g.Z)((0,l.t)(q,{variables:{title:c,limit:30,page:0}}),2),s=r[0],t=r[1],u=t.data,v=t.loading,w=(0,B.useState)(p),x=w[0],y=w[1],z=function(a,b){return y((0,f.Z)((0,e.Z)({},x),(0,d.Z)({},a,b)))},E=v||Object.values(x).some(function(a){return a.loading});return((0,B.useEffect)(function(){c&&s()},[c,s]),c)?(0,i.jsx)(m.Z,{className:"h-100 bg-dark",children:(0,i.jsx)(n.Z,{children:(0,i.jsxs)(o.Z,{children:[(0,i.jsx)(m.Z,{children:(0,i.jsx)(n.Z,{md:12,className:"my-1 px-4 py-3",style:{backgroundColor:"#33353e"},children:(0,i.jsxs)("h2",{className:"searchTitle",children:[a("Search Results for"),": ",b.query.q]})})}),E&&(0,i.jsx)(m.Z,{children:(0,i.jsx)(n.Z,{children:(0,i.jsx)(A.Z,{className:"mx-auto my-2"})})}),u&&Object.entries(h).map(function(a){var b=(0,g.Z)(a,2),d=b[0],j=b[1];return h[d]&&(0,i.jsx)(I,(0,f.Z)((0,e.Z)({search:c,category:d},j,u[d]),{setLoading:z}),d)})]})})}):null}function I(a){var b=a.count,c=a.title,d=a.items,e=a.type,f=a.search,h=a.category,j=a.query,o=a.setLoading,q=(0,B.useState)(!1),s=q[0],u=q[1],x=(0,B.useState)(d),A=x[0],C=x[1],D=(0,B.useState)(0),G=D[0],H=D[1],I=(0,B.useState)(b),J=I[0],K=I[1],L=(0,g.Z)((0,l.t)((0,k.Ps)(E(),F,j),{onCompleted:function(a){o(h,!1),C(a.result.items)},onError:function(a){console.log(a),w.Am.error("Failed to fetch some results"),K(0)}}),1),M=L[0],N=30*G,O=N+30;return(0,B.useEffect)(function(){s?(o(h,!0),M({variables:{title:f,limit:30,page:G}})):u(!0)},[G]),J>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(m.Z,{className:"mb-1 mt-4",children:[(0,i.jsx)(n.Z,{md:"auto",children:(0,i.jsxs)("h2",{children:[c," (",J>30?"".concat(N+1," - ").concat(J<O?J:O):J,")"]})}),J>30&&(0,i.jsx)(n.Z,{md:"auto",children:(0,i.jsx)(p.Z,{children:Array.from(Array(Math.ceil(J/30)),function(a,b){return(0,i.jsx)(p.Z.Link,{disabled:G===b,onClick:function(){return H(b)},className:"py-0 px-2",children:(0,i.jsx)("h2",{children:b+1})},b)})})})]}),(0,i.jsx)(m.Z,{children:A.map(function(a){return(0,i.jsx)(n.Z,{md:6,children:(0,i.jsx)(v(),{href:"/".concat(e,"/").concat(a.id),className:y().a,children:(0,i.jsxs)(m.Z,{className:r()(y().result,"mx-1 d-flex flex-row mb-3"),children:[e&&(0,i.jsx)(n.Z,{md:"auto",className:r()(y().cover,"px-0"),children:(0,i.jsx)(t(),{objectFit:"contain",alt:a.title,src:(0,z.Jn)(a.id,e),width:180,height:180,placeholder:"blur",blurDataURL:a.placeholder})}),(0,i.jsxs)(n.Z,{className:"p-2 px-4 my-auto",children:[(0,i.jsx)("h2",{children:a.title}),a.releaseDate&&(0,i.jsx)("p",{className:"card-text mt-2",children:a.releaseDate})]})]})})},a.id)})})]}):null}}},function(a){a.O(0,[774,888,179],function(){var b;return a(a.s=2252)}),_N_E=a.O()}])