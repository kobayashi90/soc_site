(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{2252:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/search",function(){return c(5935)}])},5935:function(g,b,a){"use strict";a.r(b),a.d(b,{"__N_SSP":function(){return F},default:function(){return G}});var h=a(9361),i=a(337),j=a(4941),k=a(2378),l=a(5893),m=a(1163),n=a(7283),o=a(3359),p=a(1608),q=a(1555),r=a(682),s=a(9368),c=a(4184),t=a.n(c),d=a(5675),u=a.n(d),e=a(1664),v=a.n(e),w=a(782),f=a(3920),x=a.n(f),y=a(599),z=a(9738),A=a(7294),B=a(6974);function C(){var a=(0,k.Z)(["\n  ","{\n    byTitle: ","\n    byArtist: ","\n    games: ","\n    studios: ","\n    anims: ","\n    series: ","\n  }\n  "]);return C=function(){return a},a}function D(){var a=(0,k.Z)(["\n      ","{\n        result: ","\n      }\n    "]);return D=function(){return a},a}var E="query Search($title: String!, $limit: Int!, $page: Int!)",F=!0;function G(){var b=(0,B.Z)(),d=(0,m.useRouter)(),c=d.query.q,a={byTitle:{query:"searchAlbum(title: $title, limit: $limit, page: $page){ count, items: rows { id, title, classes { name }, releaseDate, placeholder } }",title:b("Albums"),type:"album"},byArtist:{query:"searchAlbumByArtist(name: $title, limit: $limit, page: $page){ count, items: rows { id, title, classes { name }, releaseDate, placeholder } }",title:"".concat(b("Albums")," (","by artists",")"),type:"album"},games:{query:"searchGame(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name, releaseDate, placeholder } }",title:b("Games"),type:"game"},studios:{query:"searchStudio(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name } }",title:b("Studios")},anims:{query:"searchAnimation(title: $title, limit: $limit, page: $page){ count, items: rows { id, title, releaseDate, placeholder } }",title:b("Animations"),type:"anim"},series:{query:"searchSeries(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name, placeholder } }",title:b("Series"),type:"series"}},k={};Object.keys(a).forEach(function(a){k[a]=!1});var s=(0,n.Ps)(C(),E,a.byTitle.query,a.byArtist.query,a.games.query,a.studios.query,a.anims.query,a.series.query),e=(0,j.Z)((0,o.t)(s,{variables:{title:c,limit:30,page:0}}),2),t=e[0],f=e[1],u=f.data,v=f.loading,g=(0,A.useState)(k),w=g[0],y=g[1],x=v||Object.values(w).some(function(a){return a.loading});return((0,A.useEffect)(function(){c&&t()},[c,t]),c)?(0,l.jsx)(p.Z,{className:"h-100 bg-dark",children:(0,l.jsx)(q.Z,{children:(0,l.jsxs)(r.Z,{children:[(0,l.jsx)(p.Z,{children:(0,l.jsx)(q.Z,{md:12,className:"my-1 px-4 py-3",style:{backgroundColor:"#33353e"},children:(0,l.jsxs)("h2",{className:"searchTitle",children:[b("Search Results for"),": ",d.query.q]})})}),x&&(0,l.jsx)(p.Z,{children:(0,l.jsx)(q.Z,{children:(0,l.jsx)(z.Z,{className:"mx-auto my-2"})})}),u&&Object.entries(a).map(function(e){var d=(0,j.Z)(e,2),b=d[0],f=d[1];return a[b]&&(0,l.jsx)(H,(0,i.Z)({search:c,category:b},f,u[b],{setLoading:function(a,b){return y((0,i.Z)({},w,(0,h.default)({},a,b)))}}),b)})]})})}):null}function H(a){var k=a.count,m=a.title,r=a.items,F=a.type,G=a.search,H=a.category,z=a.query,I=a.setLoading,c=(0,A.useState)(!1),J=c[0],K=c[1],d=(0,A.useState)(r),B=d[0],L=d[1],e=(0,A.useState)(0),f=e[0],M=e[1],g=(0,A.useState)(k),b=g[0],N=g[1],C=(0,j.Z)((0,o.t)((0,n.Ps)(D(),E,z),{onCompleted:function(a){I(H,!1),L(a.result.items)},onError:function(a){console.log(a),w.Am.error("Failed to fetch some results"),N(0)}}),1),O=C[0],h=30*f,i=h+30;return(0,A.useEffect)(function(){J?(I(H,!0),O({variables:{title:G,limit:30,page:f}})):K(!0)},[f]),b>0?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(p.Z,{className:"mb-1 mt-4",children:[(0,l.jsx)(q.Z,{md:"auto",children:(0,l.jsxs)("h2",{children:[m," (",b>30?"".concat(h+1," - ").concat(b<i?b:i):b,")"]})}),b>30&&(0,l.jsx)(q.Z,{md:"auto",children:(0,l.jsx)(s.Z,{children:Array.from(Array(Math.ceil(b/30)),function(b,a){return(0,l.jsx)(s.Z.Link,{disabled:f===a,onClick:function(){return M(a)},className:"py-0 px-2",children:(0,l.jsx)("h2",{children:a+1})},a)})})})]}),(0,l.jsx)(p.Z,{children:B.map(function(a){return(0,l.jsx)(q.Z,{md:6,children:(0,l.jsx)(v(),{href:"/".concat(F,"/").concat(a.id),children:(0,l.jsx)("a",{className:x().a,children:(0,l.jsxs)(p.Z,{className:t()(x().result,"mx-1 d-flex flex-row mb-3"),children:[F&&(0,l.jsx)(q.Z,{md:"auto",className:t()(x().cover,"px-0"),children:(0,l.jsx)(u(),{objectFit:"contain",alt:a.title,src:(0,y.Jn)(a.id,F),width:180,height:180,placeholder:"blur",blurDataURL:a.placeholder})}),(0,l.jsxs)(q.Z,{className:"p-2 px-4 my-auto",children:[(0,l.jsx)("h2",{children:a.title}),a.releaseDate&&(0,l.jsx)("p",{className:"card-text mt-2",children:a.releaseDate})]})]})})})},a.id)})})]}):null}}},function(a){a.O(0,[774,888,179],function(){return a(a.s=2252)}),_N_E=a.O()}])