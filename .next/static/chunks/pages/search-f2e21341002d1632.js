(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{2252:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/search",function(){return s(5935)}])},5935:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSP:function(){return A},default:function(){return k}});var i=s(7297),l=s(5893),r=s(1163),a=s(7283),n=s(3359),c=s(4051),u=s(1555),m=s(682),o=s(9368),d=s(4184),h=s.n(d),p=s(9755),y=s.n(p),x=s(1664),g=s.n(x),j=s(782),b=s(3920),f=s.n(b),Z=s(599),$=s(9738),q=s(7294),N=s(6974);function _(){let e=(0,i.Z)(["\n  ","{\n    byTitle: ","\n    byArtist: ","\n    games: ","\n    studios: ","\n    anims: ","\n    series: ","\n  }\n  "]);return _=function(){return e},e}function w(){let e=(0,i.Z)(["\n      ","{\n        result: ","\n      }\n    "]);return w=function(){return e},e}let S="query Search($title: String!, $limit: Int!, $page: Int!)";var A=!0;function k(){let e=(0,N.Z)(),t=(0,r.useRouter)(),s=t.query.q,i={byTitle:{query:"searchAlbum(title: $title, limit: $limit, page: $page){ count, items: rows { id, title, categories { name }, releaseDate, placeholder } }",title:e("Albums"),type:"album"},byArtist:{query:"searchAlbumByArtist(name: $title, limit: $limit, page: $page){ count, items: rows { id, title, categories { name }, releaseDate, placeholder } }",title:"".concat(e("Albums")," (","by artists",")"),type:"album"},games:{query:"searchGame(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name, releaseDate, placeholder } }",title:e("Games"),type:"game"},studios:{query:"searchStudio(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name } }",title:e("Studios")},anims:{query:"searchAnimation(title: $title, limit: $limit, page: $page){ count, items: rows { id, title, releaseDate, placeholder } }",title:e("Animations"),type:"anim"},series:{query:"searchSeries(name: $title, limit: $limit, page: $page){ count, items: rows { id: slug, title: name, placeholder } }",title:e("Series"),type:"series"}},o={};Object.keys(i).forEach(e=>{o[e]=!1});let d=(0,a.Ps)(_(),S,i.byTitle.query,i.byArtist.query,i.games.query,i.studios.query,i.anims.query,i.series.query),[h,{data:p,loading:y}]=(0,n.t)(d,{variables:{title:s,limit:30,page:0}}),[x,g]=(0,q.useState)(o),j=(e,t)=>g({...x,[e]:t}),b=y||Object.values(x).some(e=>e.loading);return((0,q.useEffect)(()=>{s&&h()},[s,h]),s)?(0,l.jsx)(c.Z,{className:"h-100 bg-dark",children:(0,l.jsx)(u.Z,{children:(0,l.jsxs)(m.Z,{children:[(0,l.jsx)(c.Z,{children:(0,l.jsx)(u.Z,{md:12,className:"my-1 px-4 py-3",style:{backgroundColor:"#33353e"},children:(0,l.jsxs)("h2",{className:"searchTitle",children:[e("Search Results for"),": ",t.query.q]})})}),b&&(0,l.jsx)(c.Z,{children:(0,l.jsx)(u.Z,{children:(0,l.jsx)($.Z,{className:"mx-auto my-2"})})}),p&&Object.entries(i).map(e=>{let[t,r]=e;return i[t]&&(0,l.jsx)(E,{search:s,category:t,...r,...p[t],setLoading:j},t)})]})})}):null}function E(e){let{count:t,title:s,items:i,type:r,search:m,category:d,query:p,setLoading:x}=e,[b,$]=(0,q.useState)(!1),[N,_]=(0,q.useState)(i),[A,k]=(0,q.useState)(0),[E,D]=(0,q.useState)(t),[v]=(0,n.t)((0,a.Ps)(w(),S,p),{onCompleted(e){x(d,!1),_(e.result.items)},onError(e){console.log(e),j.Am.error("Failed to fetch some results"),D(0)}}),T=30*A,C=T+30;return(0,q.useEffect)(()=>{b?(x(d,!0),v({variables:{title:m,limit:30,page:A}})):$(!0)},[A]),E>0?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(c.Z,{className:"mb-1 mt-4",children:[(0,l.jsx)(u.Z,{md:"auto",children:(0,l.jsxs)("h2",{children:[s," (",E>30?"".concat(T+1," - ").concat(E<C?E:C):E,")"]})}),E>30&&(0,l.jsx)(u.Z,{md:"auto",children:(0,l.jsx)(o.Z,{children:Array.from(Array(Math.ceil(E/30)),(e,t)=>(0,l.jsx)(o.Z.Link,{disabled:A===t,onClick:()=>k(t),className:"py-0 px-2",children:(0,l.jsx)("h2",{children:t+1})},t))})})]}),(0,l.jsx)(c.Z,{children:N.map(e=>(0,l.jsx)(u.Z,{md:6,children:(0,l.jsx)(g(),{href:"/".concat(r,"/").concat(e.id),className:f().a,children:(0,l.jsxs)(c.Z,{className:h()(f().result,"mx-1 d-flex flex-row mb-3"),children:[r&&(0,l.jsx)(u.Z,{md:"auto",className:h()(f().cover,"px-0"),children:(0,l.jsx)(y(),{objectFit:"contain",alt:e.title,src:(0,Z.Jn)(e.id,r),width:180,height:180,placeholder:"blur",blurDataURL:e.placeholder})}),(0,l.jsxs)(u.Z,{className:"p-2 px-4 my-auto",children:[(0,l.jsx)("h2",{children:e.title}),e.releaseDate&&(0,l.jsx)("p",{className:"card-text mt-2",children:e.releaseDate})]})]})})},e.id))})]}):null}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=2252)}),_N_E=e.O()}]);